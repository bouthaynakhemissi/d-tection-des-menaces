rule Suspicious_Patterns
{
    meta:
        description = "Détection de patterns suspects dans les fichiers"
        author = "Votre Nom"
        date = "2025-05-16"

    strings:
        $s1 = "eval(" nocase
        $s2 = "base64_decode(" nocase
        $s3 = "exec(" nocase
        $s4 = "shell_exec(" nocase
        $s5 = "system(" nocase
        $s6 = "passthru(" nocase
        $s7 = "phpinfo(" nocase
        $s8 = "curl_exec(" nocase
        $s9 = "file_get_contents(" nocase
        $s10 = "fopen(" nocase
        $s11 = "fwrite(" nocase
        $s12 = "chmod(" nocase
        $s13 = "chown(" nocase
        $s14 = "unlink(" nocase
        $s15 = "mkdir(" nocase

    condition:
        any of ($s*)
}

rule Suspicious_Extensions
{
    meta:
        description = "Détection de fichiers avec des extensions suspectes"
        author = "Votre Nom"
        date = "2025-05-16"

    strings:
        $ext1 = ".exe" nocase
        $ext2 = ".dll" nocase
        $ext3 = ".bat" nocase
        $ext4 = ".cmd" nocase
        $ext5 = ".scr" nocase
        $ext6 = ".js" nocase
        $ext7 = ".vbs" nocase
        $ext8 = ".hta" nocase

    condition:
        any of ($ext*)
}
